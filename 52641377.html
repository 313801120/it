<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>分享互联网新闻_程序员_IT_编程_代码</title><meta name="keywords" content="分享互联网新闻_程序员_IT_编程_代码" /><meta name="description" content="分享互联网新闻_程序员_IT_编程_代码" /><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" /><meta name="apple-mobile-web-app-capable" content="yes" /><meta name="format-detection" content="telephone=no" /><link rel="Shortcut Icon" href="/Templates2018/programe/Images/favicon.ico" /><script src="/Jquery/Jquery.Min.js" type="text/javascript"></script><script src="/Templates2018/programe/Images/runAction.js?v7" type="text/javascript"></script><link href="/Templates2018/programe/Css/style.css?v6" rel="stylesheet" type="text/css" /></head><body><div id="top"><div class="top"><div class="top_left"><p>你好，欢迎来到程序员网</p></div><div class="top_right"><p><a href="javascript:void(0);" onclick="AddFavorite('js代码网',location.href)">收藏本站</a>| <a href="javascript:void(0);" onclick="SetHome(this,'http://sharembweb.com/');">设为首页</a></p></div></div></div><div class="clear10"></div><div class="mainwrap"><div class="sidebarleft"><div class="positionwrap"><a href="/index.html">首页</a>>><a href="/detail/index.html">程序员</a>>>查看内容</div><ul class="columnbox"><li class="title"><h1>TS详解</h1></li><li class="content"><div class="articletimes">作者： 发表于：2018-09-16 21:39:04</div><div class="articlecontent">TS详解<div class='clear10'></div>2014-04-14&nbsp;&nbsp;傻葩小子&nbsp;&nbsp;+&nbsp;关注献花(0)<div class='clear10'></div><div class='clear10'></div>http://blog.csdn.net/yangzhiloveyou/article/details/8709188<div class='clear10'></div>数字电视的TS包和TS流的组成和功能<div class='clear10'></div>综合考虑几下几个因素：<div class='clear10'></div>（1）包的长度不能过短，否则包头开销所占比例过大，<div class='clear10'></div>导致传输效率下降<div class='clear10'></div>（2）包的长度不能过长，否则在丢失同步的情况下恢复同步的<div class='clear10'></div>周期过长，导致较多的信息丢失<div class='clear10'></div>（3）其他环境相适配，如纠错编码，宽带网等。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;TS包按功能分为链接头，适配域，净荷。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;链接头的长度固定，4个字节<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;适配域的长度从0字节到184字节可变，可以没有，也可以扩展到整个TS包<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;净荷数据的长度从0字节到184字节可变。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;整个TS流是由许多长度为188字节的TS包周期性的排列而形成的。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;链接头包含4个字节的内容，主要负责TS包的同步、各种ES流的表示、TS包传输差错的检测和条件接收等功能。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（1）包同步<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;是包中的第一个字节，TS包以固定的8bit的同步字节开始，所有的TS传送包，同步字都是唯一的OX47，用于建立发送端和接收端包的同步。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（2）包差错指示<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;用于从解码器向分接器指示传输误码。若这个比特被设置，表示此TS包中所携带的净荷信息有错误，无法使用。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（3）净荷单元起始指示<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;标志PES包头以及包含节目特定信息的表（PMT，PAT）的头是否出现在该包中，在失步后的重新同步中起着重要的作用。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（4）传送优先级<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;用于表示包中含有重要数据，应予以优先传送。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;6）加扰控制<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;传送信息通过加入扰码来加密，各个基本码流可以独立进行加扰。加扰控制字段说明TS包中的净荷数据是否加扰。如果加扰，标志出解扰的密匙。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（5）包标识符PID<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PID是识别TS包的重要参数，用来识别TS包所承载的数据。在TS码流生成时，每一类业务（视频，音频，数据）的基本码流均被赋予一个不同的识别号PID，解码器借助于PID判断某一个TS包属于哪一类业务的基本码流。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（7）适配域控制<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;标志TS包是否有适配域存在，如果存在，在其内部是否有净荷存在。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（8）循环计数器<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;用于对传输误码进行检测。在发送端对所有的包都做0-15的循环计数，在接收终端，如发现循环计数器的值有中断，表明数据在传输中有丢失。<div class='clear10'></div>&nbsp;<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;适配域是一个可变长度的域，它在TS包中是否存在，由适配域控制标识决定。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;功能：1、同步和定时<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2、随机进入压缩的码流<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3、当地节目插入<div class='clear10'></div>&nbsp;<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;在数字压缩编码系统中，由于每个图像的数据是不同的（图像的编码方法和复杂程度不同），这样不可能从图像数据的起始部分直接获取定时信息。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;每隔一定的传送时间，在TS包适配域中传送系统时钟27MHz的一个采样值给接收机，作为解码器的时钟基准信号，称为节目时钟基准（PCR）。PCR通常每隔100ms至少传送一次。<div class='clear10'></div>随机进入压缩的码流<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;在视频码流中存在I帧，B帧，P帧三种编码帧类型，只有I帧编码数据可以独立进行解码。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;在节目调谐或节目更换时需要随时进入音频或视频，随机进入应该是I帧，在I帧前面的视频序列的头部应该有一个随机进入点。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;随机进入指标就是表明随机进入点的位置。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;在电视广播中，常需要进行本地节目和广告的插入，在MPEG-2传送系统中，使用TS包适配域中的一些标志来支持。插入节目的PCR值与插入前节目的PCR值是不同的，因此通知解码器，要尽快与插入节目建立同步关系。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;节目插入点必然是随机进入点，但并不是所有的随机进入点都适合作为节目插入点。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;MPEG-2解码器接收到MPEG-2 TS流时，首先检测包结构，在TS流中查找同步字节：<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;总是OX47，总位于TS包开始位置，固定间隔为188字节。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;同时满足这两个条件，可以确定同步。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;如果出现一个字节为47hex(OX47)，解码器将检测这个字节前后n倍188字节的位置是否也是同步字节。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;如果是，则当前字节为同步字节；<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;否则，当前字节只是码流中偶尔出现的47hex，不是同步字节。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;接收端收到5个TS包之后开始同步。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;丢包3个之后解码器即失步。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;TS包中净荷所承载的信息包括以下3种：<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;1、视频/音频的PES包以及辅助数据<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;2、描述单路节目复用信息的节目映射表（PMT）<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;3、描述单路节目复用信息的节目关联表（PAT）<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;1）系统复用时，对视频和音频的ES流进行打包，形成视频和音频的PES流，辅助数据不需要打成PES包.<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（2）视频和音频的PES包以一帧编码图像为单位，音频PES包恒定长度，视频PES包长度可变。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（3）PES包的长度通常都是远大于TS包的长度，一个PES包必须由整数个TS包来传送，TS包没装满的填充字节。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;（4）TS包长度固定，188字节，有效净荷184字节。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PMT表包含了与单路节目复用有关的节目信息，典型的构成包括1路视频ES流，2-5路音频ES流，1路或多路辅助数据。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;进行TS流复用时，各路ES流被分配了唯一的PID,ES流域被分配的PID值间的关系构成了一张表，称为节目映射表PMT。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PMT完整描述了一路节目由哪些ES流组成，他们的PID分别是什么。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;MPEG-2传送层中，传送PMT表的码流称为控制码流，和其他ES流一样，在TS包的净荷中传送，分配唯一的PID.<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PAT包含了与多路节目复用有关的控制信息。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PAT描述了系统级复用中传送每路节目PMT的码流的PID。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PAT作为一个独立的码流，装载在TS包的净荷中传送，分配唯一的PID。传送PAT的码流的PID值定义为固定的数值“0”。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;若复用时遇到有不同码流的PID值相同，则在进行系统复用时进行修改，修改必须同时记录在PAT和PMT中。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;允许单路数字电视节目可由其中某些节目流任意组合构成，节目可根据需要ES码流进行增加或删除。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;允许对多路节目进行灵活复用，若其中某些节目流发生变化，只需要将PAT和PMT做相应修改即可。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;能够在TS级上提供本地节目插入和条件接收等对广播界非常重要的功能。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;<div class='clear10'></div><div class='clear10'></div><div class='clear10'></div><div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PAT<div class='clear10'></div>–&nbsp;&nbsp;每个TS流一个，每隔0.5秒重复。<div class='clear10'></div>–&nbsp;&nbsp;描述TS流中有多少个节目。<div class='clear10'></div>–&nbsp;&nbsp;包含该表的TS包的PID为0，便于识别。<div class='clear10'></div>–&nbsp;&nbsp;PAT的payload中传送特殊PID的列表，每个PID对应一个节目。<div class='clear10'></div>–&nbsp;&nbsp;这些PID是描述每个独立节目详细信息的指针。<div class='clear10'></div>–&nbsp;&nbsp;PID指向PMT表。<div class='clear10'></div><div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;PMT<div class='clear10'></div>–&nbsp;&nbsp;对应TS包有特殊的PID和特殊的payload。<div class='clear10'></div>–&nbsp;&nbsp;PMT的PID由PAT传送。<div class='clear10'></div>–&nbsp;&nbsp;例如要接收节目3时，先从PAT的payload中的所有PID列表中选出节目3的PID为1FF3hex，然后查找包头中PID=1FF3hex的TS包，就是节目3的PMT。<div class='clear10'></div>–&nbsp;&nbsp;PMT包含该节目中所有ES流（视频、音频或数据）的PID。<div class='clear10'></div>&nbsp;<div class='clear10'></div><div class='clear10'></div><div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;一个节目可能有多个视频和音频流，解码器必须选择2个PID，一个视频流的PID（100hex），一个音频流的PID（200hex）。<div class='clear10'></div>·&nbsp;&nbsp;&nbsp;&nbsp;此后解码器只收集这些TS包，解复用，重新组成PES包，这些PES包再送到视频或音频解码器。<div class='clear10'></div>·&nbsp                <footer class="articlefooter">标签： </footer><ul class="updownarticlewrap"><li><a href="/detail/76747302.html">上一篇：论编程是吃青春饭的职业。</a></li><li><a href="/detail/78941683.html">下一篇：IT 界那些朗朗上口的“名言”</a></li></ul></div></li></ul></div><div class="sidebarright"><ul class="columnbox"><li class="title">相关文章</li><li class="content"><ul class="list"><li><a href="/detail/80839854.html" title="两年Java，你凭什么要15k？程序员：这就嫉妒了？白菜价好吧">两年Java，你凭什么要15k？程序员：这就嫉妒了？白菜价好吧</a></li><li><a href="/detail/80267720.html" title="一位90后程序员的自述：如何从年薪3w到30w">一位90后程序员的自述：如何从年薪3w到30w</a></li><li><a href="/detail/81125835.html" title="伤不起的三十岁，干不动的程序员要何去何从？（三条路：技术专家，行业专家，转为管理）">伤不起的三十岁，干不动的程序员要何去何从？（三条路：技术专家，行业专家，转为管理...</a></li><li><a href="/detail/54835639.html" title="从华为45岁退休看IT人员的归宿">从华为45岁退休看IT人员的归宿</a></li><li><a href="/detail/81074522.html" title="今天面试了一个34岁大龄程序员，有感而发">今天面试了一个34岁大龄程序员，有感而发</a></li><li><a href="/detail/76718583.html" title="人工智能时代即将到来—作为程序员你准备好了吗">人工智能时代即将到来—作为程序员你准备好了吗</a></li><li><a href="/detail/79050049.html" title="为什么有些程序员悄无声息渡过35岁中年危机？">为什么有些程序员悄无声息渡过35岁中年危机？</a></li><li><a href="/detail/78692583.html" title="为什么总说程序员是吃青春饭的？真的是 35 岁混不到管理就等于失业？">为什么总说程序员是吃青春饭的？真的是 35 岁混不到管理就等于失业？</a></li><li><a href="/detail/80511886.html" title="为什么很多公司都不招大龄程序员?">为什么很多公司都不招大龄程序员?</a></li><li><a href="/detail/80743029.html" title="为什么很多IT公司不喜欢进过培训机构的人呢？">为什么很多IT公司不喜欢进过培训机构的人呢？</a></li><li><a href="/detail/55212818.html" title="你是否属于有两三年工作经验但对自己的前途感到迷茫的程序员">你是否属于有两三年工作经验但对自己的前途感到迷茫的程序员</a></li><li><a href="/detail/80632406.html" title="为什么亚马逊不收购阿里巴巴, 程序员: 亚马逊未必买得起阿里巴巴">为什么亚马逊不收购阿里巴巴, 程序员: 亚马逊未必买得起阿里巴巴</a></li><li><a href="/detail/52170691.html" title="你绝对想不到年过40岁的程序员可以有多么牛X!，程序员出路">你绝对想不到年过40岁的程序员可以有多么牛X!，程序员出路</a></li><li><a href="/detail/50948717.html" title="不喜欢写代码的程序员最适合转行的10大职业">不喜欢写代码的程序员最适合转行的10大职业</a></li><li><a href="/detail/41977361.html" title="三种类型的程序员，你属于哪一种？">三种类型的程序员，你属于哪一种？</a></li><li><a href="/detail/68926446.html" title="三十岁程序员的迷茫">三十岁程序员的迷茫</a></li><li><a href="/detail/17120829.html" title="一段关于IT职业规划的对白">一段关于IT职业规划的对白</a></li><li><a href="/detail/50457111.html" title="一名70后程序员的心声">一名70后程序员的心声</a></li><li><a href="/detail/79896355.html" title="一名5年工作经验的程序员应该具备的技能">一名5年工作经验的程序员应该具备的技能</a></li><li><a href="/detail/50650384.html" title="一位程序员工作10年总结的13个忠告，却让很多人惋惜">一位程序员工作10年总结的13个忠告，却让很多人惋惜</a></li><li><a href="/detail/51758779.html" title="一位程序员工作10年总结的13个忠告">一位程序员工作10年总结的13个忠告</a></li><li><a href="/detail/16944597.html" title="一位女程序员的奋斗路程">一位女程序员的奋斗路程</a></li><li><a href="/detail/80659811.html" title="100个只有程序员才能懂的梗">100个只有程序员才能懂的梗</a></li><li><a href="/detail/48458317.html" title="为什么常说程序员35岁是道坎？">为什么常说程序员35岁是道坎？</a></li><li><a href="/detail/65635217.html" title="别转管理，十年程序员老鸟给新手的几条忠告">别转管理，十年程序员老鸟给新手的几条忠告</a></li><li><a href="/detail/53873192.html" title="大龄程序员的出路在哪里！40岁50岁你还有精力每天抱着电脑写程序吗？">大龄程序员的出路在哪里！40岁50岁你还有精力每天抱着电脑写程序吗？</a></li><li><a href="/detail/80447589.html" title="大龄程序员怎样渡过中年危机？（转）">大龄程序员怎样渡过中年危机？（转）</a></li><li><a href="/detail/1716442.html" title="培训阴影下的JAVA程序员出路在何方？">培训阴影下的JAVA程序员出路在何方？</a></li><li><a href="/detail/70242897.html" title="培训班出身的程序员为什么遭人嫌弃">培训班出身的程序员为什么遭人嫌弃</a></li><li><a href="/detail/78468539.html" title="在几年后，程序员的薪资会一直这么高么？">在几年后，程序员的薪资会一直这么高么？</a></li></ul></li></ul></div><div class="clear"></div></div></body></html>